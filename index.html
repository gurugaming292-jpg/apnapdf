<script>
async function addWatermark() {
  const { PDFDocument, rgb, degrees, StandardFonts } = PDFLib;

  const file = document.getElementById('pdfFile').files[0];
  if (!file) {
    alert("Please select a PDF file");
    return;
  }

  const arrayBuffer = await file.arrayBuffer();
  const pdfDoc = await PDFDocument.load(arrayBuffer);
  const pages = pdfDoc.getPages();
  const font = await pdfDoc.embedFont(StandardFonts.HelveticaBold);

  pages.forEach(page => {
    const { width, height } = page.getSize();

    // WATERMARK TEXT
    page.drawText("search on TG :- @Premium_PDFSS", {
      x: width / 4,
      y: height / 2,
      size: 40,
      font: font,
      color: rgb(0.7, 0.7, 0.7),
      rotate: degrees(45),
      opacity: 0.25,
    });

    // FULL PAGE CLICKABLE LINK
    page.drawRectangle({
      x: 0,
      y: 0,
      width: width,
      height: height,
      color: rgb(1,1,1),
      opacity: 0,
      borderWidth: 0,
    });

    page.node.set(PDFLib.PDFName.of('Annots'),
      pdfDoc.context.obj([pdfDoc.context.obj({
        Type: 'Annot',
        Subtype: 'Link',
        Rect: [0, 0, width, height],
        Border: [0, 0, 0],
        A: {
          Type: 'Action',
          S: 'URI',
          URI: 'https://t.me/Premium_PDFSS'
        }
      })])
    );

  });

  const pdfBytes = await pdfDoc.save();

  const blob = new Blob([pdfBytes], { type: "application/pdf" });
  const url = URL.createObjectURL(blob);

  const a = document.createElement("a");
  a.href = url;
  a.download = file.name;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
}
</script>

